## å¼•å‡º

- > åœ¨è®¸å¤šåˆ†ç±»ç®—æ³•åº”ç”¨ä¸­ï¼Œç‰¹å¾å’Œæ ‡ç­¾ä¹‹é—´çš„å…³ç³»å¹¶éæ˜¯å†³å®šæ€§çš„ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬æƒ³é¢„æµ‹ä¸€ä¸ªäººç©¶ç«Ÿæ˜¯å¦ä¼šåœ¨æ³°å¦å°¼å…‹å·æµ·éš¾ä¸­ç”Ÿå­˜ä¸‹æ¥ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å»ºç«‹æŸä¸ªåˆ†ç±»æ¨¡å‹æ¥å­¦ä¹ æˆ‘ä»¬çš„è®­ç»ƒé›†ã€‚åœ¨è®­ç»ƒä¸­ï¼Œå…¶ä¸­ä¸€ä¸ªäººçš„ç‰¹å¾ä¸º:30å²ï¼Œç”·ï¼Œæ™®é€šèˆ±ï¼Œä»–æœ€ååœ¨æ³°å¦å°¼å…‹å·æµ·éš¾ä¸­å»ä¸–äº†ã€‚å½“æˆ‘ä»¬æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å‘ç°æœ‰å¦ä¸€ä¸ªäººçš„ç‰¹å¾ä¹Ÿä¸º:30å²ï¼Œç”·ï¼Œæ™®é€šèˆ±ã€‚åŸºäºåœ¨è®­ç»ƒé›†ä¸­çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å¿…ç„¶ä¼šç»™è¿™ä¸ªäººæ‰“ä¸Šæ ‡ç­¾:å»ä¸–ã€‚ç„¶è€Œè¿™ä¸ªäººçš„çœŸå®æƒ…å†µä¸€å®šæ˜¯å»ä¸–äº†å—?å¹¶éå¦‚æ­¤ã€‚ä¹Ÿè®¸è¿™ä¸ªäººæ˜¯å¿ƒè„ç—…æ‚£è€…ï¼Œå¾—åˆ°äº†ä¸Šæ•‘ç”Ÿè‰‡çš„ä¼˜å…ˆæƒã€‚åˆæœ‰å¯èƒ½ï¼Œè¿™ä¸ªäººå°±æ˜¯æŒ¤ä¸Šäº†æ•‘ç”Ÿè‰‡ï¼Œæ´»äº†ä¸‹æ¥ã€‚å¯¹åˆ†ç±»ç®—æ³•æ¥è¯´ï¼ŒåŸºäºè®­ç»ƒçš„ç»éªŒï¼Œè¿™ä¸ªäººâ€œå¾ˆæœ‰å¯èƒ½â€æ˜¯æ²¡æœ‰æ´»ä¸‹æ¥ï¼Œä½†ç®—æ³•æ°¸è¿œä¹Ÿæ— æ³•ç¡®å®šâ€è¿™ä¸ªäººä¸€å®šæ²¡æœ‰æ´»ä¸‹æ¥â€œã€‚å³ä¾¿è¿™ä¸ªäººæœ€åçœŸçš„æ²¡æœ‰æ´»ä¸‹æ¥ï¼Œç®—æ³•ä¹Ÿæ— æ³•ç¡®å®šåŸºäºè®­ç»ƒæ•°æ®ç»™å‡ºçš„åˆ¤æ–­ï¼Œæ˜¯å¦çœŸçš„è§£é‡Šäº†è¿™ä¸ªäººæ²¡æœ‰å­˜æ´»ä¸‹æ¥çš„çœŸå®æƒ…å†µã€‚

- > è¿™å°±æ˜¯è¯´ï¼Œç®—æ³•å¾—å‡ºçš„ç»“è®ºï¼Œæ°¸è¿œä¸æ˜¯100%ç¡®å®šçš„ï¼Œæ›´å¤šçš„æ˜¯åˆ¤æ–­å‡ºäº†ä¸€ç§â€œæ ·æœ¬çš„æ ‡ç­¾æ›´å¯èƒ½æ˜¯æŸç±»çš„å¯èƒ½æ€§â€ï¼Œè€Œéä¸€ç§â€œç¡®å®šâ€ã€‚æˆ‘ä»¬é€šè¿‡æ¨¡å‹ç®—æ³•çš„æŸäº›è§„å®šï¼Œæ¥å¼ºè¡Œè®©ç®—æ³•ä¸ºæˆ‘ä»¬è¿”å›ä¸€ä¸ªå›ºå®šçš„åˆ†ç±»ç»“æœã€‚ä½†è®¸å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¸Œæœ›èƒ½å¤Ÿç†è§£ç®—æ³•åˆ¤æ–­å‡ºç»“æœçš„å¯èƒ½æ€§æ¦‚ç‡ã€‚

- > æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›ä½¿ç”¨çœŸæ­£çš„æ¦‚ç‡æ¥è¡¡é‡å¯èƒ½æ€§ï¼Œå› æ­¤å°±æœ‰äº†çœŸæ­£çš„æ¦‚ç‡ç®—æ³•:æœ´ç´ è´å¶æ–¯ã€‚

- > æœ´ç´ è´å¶æ–¯æ˜¯ä¸€ç§ç›´æ¥è¡¡é‡æ ‡ç­¾å’Œç‰¹å¾ä¹‹é—´çš„æ¦‚ç‡å…³ç³»çš„æœ‰ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œæ˜¯ä¸€ç§ä¸“æ³¨åˆ†ç±»çš„ç®—æ³•ã€‚æœ´ç´ è´å¶æ–¯çš„ç®—æ³•æ ¹æºå°±æ˜¯åŸºäºæ¦‚ç‡è®ºå’Œæ•°ç†ç»Ÿè®¡çš„è´å¶æ–¯ç†è®ºï¼Œå› æ­¤å®ƒæ˜¯æ ¹æ­£è‹—çº¢çš„æ¦‚ç‡æ¨¡å‹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥è®¤è¯†ä¸€ä¸‹è¿™ä¸ªç®€å•å¿«é€Ÿçš„æ¦‚ç‡ç®—æ³•ã€‚

- ç°åœ¨æˆ‘ä»¬å¯¹é‚®ç®±çš„é‚®ä»¶å’Œæ–‡ç« è¿›è¡Œåˆ†ç±»

  ![1587105374182](asserts/1587105374182.png)

  ![1587105387049](asserts/1587105387049.png)

  >ä¸Šå›¾æ‰€ç¤ºï¼Œæ˜¯ä¸æ˜¯è¯´ï¼Œå“ªä¸ªç±»åˆ«å çš„æ¯”ä¾‹æ¯”è¾ƒå¤§ï¼Œåˆ™å°†é‚®ä»¶æˆ–è€…æ–‡ç« å½’ä¸ºå“ªä¸€ç±»å‘¢ï¼Ÿè¿™é‡Œçš„å æ¯”æŒ‡çš„æ˜¯åˆ†ç±»çš„æ¦‚ç‡ã€‚

## æ¦‚ç‡åŸºç¡€

- æ¦‚å¿µï¼šæ¦‚ç‡å®šä¹‰ä¸ºä¸€ä»¶äº‹æƒ…å‘ç”Ÿçš„å¯èƒ½æ€§ã€‚

  - æ‰”ä¸€ä¸ªç¡¬å¸ï¼Œæ­£é¢æœä¸Š
  - æŸå¤©æ˜¯é˜´å¤©

- å®ä¾‹

  ![1587105484707](asserts/1587105484707.png)

  - å¥³ç¥å–œæ¬¢ä¸€ä¸ªäººçš„æ¦‚ç‡

    > 4/7

  - èŒä¸šæ˜¯ç¨‹åºå‘˜å¹¶ä¸”ä½“å‹åŒ€ç§°çš„æ¦‚ç‡

    - è”åˆæ¦‚ç‡ï¼š3/7 * 4/7 = 12/49
    - P(ç¨‹åºå‘˜ï¼ŒåŒ€ç§°)=P(ç¨‹åºå‘˜)*P(åŒ€ç§°)

  - åœ¨å¥³ç¥å–œæ¬¢çš„æ¡ä»¶ä¸‹ï¼ŒèŒä¸šæ˜¯ç¨‹åºå‘˜çš„æ¦‚ç‡

    > æ¡ä»¶æ¦‚ç‡P(ç¨‹åºå‘˜|å¥³ç¥å–œæ¬¢)ï¼š1/2

  - åœ¨å¥³ç¥å–œæ¬¢çš„æ¡ä»¶ä¸‹ï¼ŒèŒä¸šæ˜¯äº§å“ï¼Œä½“é‡è¶…é‡çš„æ¦‚ç‡

    - æ¡ä»¶æ¦‚ç‡ï¼šP(äº§å“ï¼Œè¶…é‡|å¥³ç¥å–œæ¬¢) = P(äº§å“|å¥³ç¥å–œæ¬¢) * P(è¶…é‡|å¥³ç¥å–œæ¬¢)
    - 1/2 * 1/4 = 1/8

- æ¦‚ç‡è®¡ç®—å‡†åˆ™ï¼šè”åˆæ¦‚ç‡å’Œæ¡ä»¶æ¦‚ç‡

  ![1587105575674](asserts/1587105575674.png)

- æ³¨æ„

  - ä¸Šè¿°çš„æ±‚æ¦‚ç‡å…¬å¼åªé€‚ç”¨äºå„ä¸ªç‰¹å¾ä¹‹é—´æ˜¯æ¡ä»¶ç‹¬ç«‹ï¼ˆæ¯ä¸ªç‰¹å¾ä¹‹é—´æ²¡æœ‰å¿…ç„¶å…³ç³»ï¼‰çš„ã€‚æ¡ä»¶ä¸ç‹¬ç«‹æŒ‡çš„æ˜¯ç‰¹å¾ä¹‹é—´æœ‰å…³è”çš„æ¯”å¦‚ï¼Œä½“é‡å’Œæ˜¯å¦å–œæ¬¢åƒé›¶é£Ÿè¿™ä¸¤ä¸ªæ¡ä»¶ä¹‹é—´å°±æœ‰å…³è”ã€‚
  - æœ´ç´ è´å¶æ–¯åªé€‚ç”¨äºç‰¹å¾ä¹‹é—´æ˜¯æ¡ä»¶ç‹¬ç«‹çš„æƒ…å†µä¸‹ã€‚å¦åˆ™åˆ†ç±»æ•ˆæœä¸å¥½ã€‚è¿™é‡Œçš„æœ´ç´ æŒ‡çš„å°±æ˜¯æ¡ä»¶ç‹¬ç«‹ã€‚
  - æœ´ç´ è´å¶æ–¯ä¸»è¦è¢«å¹¿æ³›çš„é€‚ç”¨äºæ–‡æ¡£åˆ†ç±»ä¸­ï¼

## æœ´ç´ è´å¶æ–¯çš„åˆ†ç±»

- åœ¨sk-learnä¸­æä¾›äº†ä¸‰ç§ä¸åŒç±»å‹çš„è´å¶æ–¯æ¨¡å‹ç®—æ³•
  - é«˜æ–¯æ¨¡å‹
  - å¤šé¡¹å¼æ¨¡å‹
  - ä¼¯åŠªåˆ©æ¨¡å‹

- ä¸»è¦åº”ç”¨

  > æ–‡ç« åˆ†ç±»

### é«˜æ–¯æ¨¡å‹

- ä»‹ç»

  - å¤§å®¶åœ¨å­¦ä¹ é«˜ç­‰æ•°å­¦æ—¶ï¼Œåº”è¯¥å­¦è¿‡é«˜æ–¯åˆ†å¸ƒï¼Œä¹Ÿå°±æ˜¯æ­£æ€åˆ†å¸ƒï¼Œæ˜¯ä¸€ç§è¿ç»­å‹å˜é‡çš„æ¦‚ç‡åˆ†å¸ƒã€‚ç®€å•æ¥è¯´ï¼Œé«˜æ–¯åˆ†å¸ƒå°±æ˜¯å½“é¢‘ç‡ç›´æ–¹å›¾çš„åŒºé—´å˜å¾—ç‰¹åˆ«å°æ—¶çš„æ‹Ÿåˆæ›²çº¿ï¼Œåƒåº§å°å±±å³°ï¼Œå…¶ä¸­ä¸¤ç«¯çš„ç‰¹åˆ«å°ï¼Œè¶Šå¾€ä¸­é—´è¶Šé«˜ã€‚

  - æ‰€è°“æ­£æ€åˆ†å¸ƒï¼Œå°±æ˜¯æ­£å¸¸å½¢æ€çš„åˆ†å¸ƒï¼Œå®ƒæ˜¯è‡ªç„¶ç•Œçš„ä¸€ç§è§„å¾‹ã€‚

    > ç°å®ç”Ÿæ´»ä¸­æœ‰å¾ˆå¤šç°è±¡å‡æœä»é«˜æ–¯åˆ†å¸ƒï¼Œæ¯”å¦‚æ”¶å…¥ï¼Œèº«é«˜ï¼Œä½“é‡ç­‰ï¼Œå¤§éƒ¨åˆ†éƒ½å¤„äºä¸­ç­‰æ°´å¹³ï¼Œç‰¹åˆ«å°‘å’Œç‰¹åˆ«å¤šçš„æ¯”ä¾‹éƒ½ä¼šæ¯”è¾ƒä½ã€‚

#### é«˜æ–¯åˆ†å¸ƒï¼ˆæ­£å¤ªåˆ†å¸ƒï¼‰

- ä¸€èµ·ç©ä¸€ä¸ªæ¸¸æˆæŠ›ç¡¬å¸ï¼Œæ¸¸æˆè§„åˆ™ä¸º

  - å®šä¹‰æ¯ä¸ªæŠ›å‡ºç¡¬å¸æ­£é¢è®°+1åˆ†ï¼Œåé¢è®°-1åˆ†
  - æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å¾—çŸ¥æŠ›ä¸€æ¬¡ç¡¬å¸ä¸ºæ­£é¢çš„æ¦‚ç‡å’Œä¸ºåé¢çš„æ¦‚ç‡å„ä½50%ï¼Œé‚£ä¹Ÿå°±æ˜¯ä¼šæœ‰ä¸€åŠæ¦‚ç‡+1åˆ†ï¼Œä¸€åŠæ¦‚ç‡-1åˆ†ã€‚

- å¦‚æœæˆ‘ä»¬è¿ç»­æŠ›10æ¬¡ç¡¬å¸ï¼Œåˆ™å¾—åˆ°çš„è®°åˆ†ç»Ÿè®¡ä¸º

  ![1587105802522](asserts/1587105802522.png)

- å½“ç„¶ï¼ŒåŒæ ·ç”»ä¸ªå›¾æ„Ÿå—ä¸€ä¸‹

  ![1587105828835](asserts/1587105828835.png)

- å¦‚æœæŠ›100æ¬¡ï¼Œç”šè‡³æ˜¯æ— ç©·å¤šæ¬¡å‘¢ï¼Ÿå¹³å‡åˆ†æ•°åˆ†å¸ƒæƒ…å†µå¤§æ¦‚æ˜¯ä»€ä¹ˆæ ·å‘¢ï¼Ÿç”»ä¸ªå›¾æ„Ÿå—ä¸€ä¸‹ã€‚

  ![1587105860464](asserts/1587105860464.png)

  > å‡ºç°äº†æ­£æ€åˆ†å¸ƒ

- ä¸ºä»€ä¹ˆåœ¨æˆ‘ä»¬çš„ç°å®ç”Ÿæ´»ä¸­æ­£æ€åˆ†å¸ƒå¦‚æ­¤å¸¸è§å‘¢ï¼Ÿ

  - é€šå¸¸æƒ…å†µä¸‹ä¸€ä¸ªäº‹ç‰©çš„å½±å“å› ç´ å¾€å¾€æœ‰å¤šä¸ªï¼Œæ¯”å¦‚èº«é«˜çš„å½±å“æœ‰ï¼š
    - å®¶åº­çš„é¥®é£Ÿä¹ æƒ¯
    - å®¶åº­é•¿è¾ˆçš„èº«é«˜
    - è¿åŠ¨æƒ…å†µ
    - ......
  - å…¶ä¸­çš„æ¯ä¸€ä¸ªå› ç´ ï¼Œéƒ½ä¼šå¯¹èº«é«˜äº§ç”Ÿä¸€å®šçš„å½±å“ï¼Œè¦ä¹ˆæ˜¯æ­£å‘çš„å½±åƒï¼Œè¦ä¹ˆæ˜¯åå‘çš„å½±å“ã€‚æ‰€æœ‰å› ç´ æœ€ç»ˆè®©æ•´ä½“èº«é«˜æ¥è¿‘äºæ­£æ€åˆ†å¸ƒã€‚
  - åœ¨æ•°å­¦ä¸­æ­£æ€åˆ†å¸ƒå¾€å¾€è¢«ç§°ä¸ºé«˜æ–¯åˆ†å¸ƒ

- é«˜æ–¯åˆ†å¸ƒ

  - é€šè¿‡å‡è®¾P(xi|Y)æ˜¯æœä»é«˜æ–¯åˆ†å¸ƒ(ä¹Ÿå°±æ˜¯æ­£æ€åˆ†å¸ƒ)ï¼Œæ¥ä¼°è®¡æ¯ä¸ªç‰¹å¾ä¸‹åˆ†åˆ°æ¯ä¸ªç±»åˆ«Yä¸Šçš„æ¡ä»¶æ¦‚ç‡ã€‚å¯¹äºæ¯ä¸ªç‰¹å¾ä¸‹çš„å–å€¼ï¼Œé«˜æ–¯æœ´ç´ è´å¶æ–¯æœ‰å¦‚ä¸‹å…¬å¼:

  - expå‡½æ•°ä¸ºé«˜ç­‰æ•°å­¦é‡Œä»¥è‡ªç„¶å¸¸æ•°eä¸ºåº•çš„æŒ‡æ•°å‡½æ•°

    ![1587105965247](asserts/1587105965247.png)

- é«˜æ–¯åˆ†å¸ƒæ¨¡å‹çš„ä½œç”¨

  - åœ¨è´å¶æ–¯åˆ†ç±»ä¸­ï¼Œé«˜æ–¯æ¨¡å‹å°±æ˜¯ç”¨æ¥å¤„ç†**è¿ç»­å‹ç‰¹å¾å˜é‡**çš„ï¼Œå½“ä½¿ç”¨æ­¤æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬ä¼šå‡å®šç‰¹å¾å±äºé«˜æ–¯åˆ†å¸ƒï¼Œç„¶ååŸºäºè®­ç»ƒæ ·æœ¬è®¡ç®—ç‰¹å¾æ‰€å±æ ‡ç­¾çš„å‡å€¼(ğœ‡)å’Œæ ‡å‡†å·®(ğ›”)ï¼Œè¿™æ ·å°±å¯ä»¥ä¼°è®¡æŸä¸ªç‰¹å¾å±äºæŸä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚

    > æ¯”å¦‚ï¼šåˆ¤æ–­ä¸€ä¸ªäººå¸…è¿˜æ˜¯ä¸‘ï¼Œåˆ™å¸…&ä¸‘å°±æ˜¯åˆ†ç±»çš„æ ‡ç­¾ï¼Œä¸€ä¸ªäººçš„ç‰¹å¾å‡è®¾æœ‰èº«é«˜ã€ä½“é‡ï¼Œä¸‰å›´ï¼Œåˆ™é«˜æ–¯æ¨¡å‹ä¼šè®¡ç®—å¸¦æœ‰èº«é«˜çš„ç‰¹å¾åˆ†åˆ°å¸…çš„æ¡ä»¶æ¦‚ç‡å’Œä¸‘çš„æ¡ä»¶æ¦‚ç‡ï¼Œåœ¨è®¡ç®—å¸¦æœ‰ä½“é‡çš„ç‰¹å¾åˆ†åˆ°å¸…å’Œä¸‘çš„æ¡ä»¶æ¦‚ç‡ï¼Œä»¥æ­¤ç±»æ¨ã€‚

  - å¯¹äºä»»æ„ä¸€ä¸ªYçš„å–å€¼ï¼Œè´å¶æ–¯éƒ½ä»¥æ±‚è§£æœ€å¤§åŒ–çš„Pä¸ºç›®æ ‡ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å¤Ÿæ¯”è¾ƒåœ¨ä¸åŒæ ‡ç­¾ä¸‹æˆ‘ä»¬çš„æ ·æœ¬ç©¶ ç«Ÿæ›´é è¿‘å“ªä¸€ä¸ªå–å€¼ã€‚ä»¥æœ€å¤§åŒ–Pä¸ºç›®æ ‡ï¼Œé«˜æ–¯æœ´ç´ è´å¶æ–¯ä¼šä¸ºæˆ‘ä»¬æ±‚è§£å…¬å¼ä¸­çš„å‚æ•°ğœ‡yå’Œğ›”yã€‚æ±‚è§£å‡ºå‚æ•°åï¼Œå¸¦å…¥ä¸€ä¸ªxiçš„å€¼ï¼Œå°±èƒ½å¤Ÿå¾—åˆ°ä¸€ä¸ªPçš„æ¦‚ç‡å–å€¼ã€‚

- é«˜æ–¯æ¨¡å‹API

  - from sklearn.naive_bayes import GaussianNB

    > å®ä¾‹åŒ–æ¨¡å‹å¯¹è±¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸éœ€è¦å¯¹é«˜æ–¯æœ´ç´ è´å¶æ–¯ç±»è¾“å…¥ä»»ä½•çš„å‚æ•°ï¼Œå¯ä»¥è¯´æ˜¯ä¸€ä¸ªéå¸¸è½»é‡çº§çš„ç±»ï¼Œæ“ä½œéå¸¸å®¹æ˜“ã€‚ä½†è¿‡äºç®€å•ä¹Ÿæ„å‘³ç€è´å¶æ–¯æ²¡æœ‰å¤ªå¤šçš„å‚æ•°å¯ä»¥è°ƒæ•´ï¼Œå› æ­¤è´å¶æ–¯ç®—æ³•çš„æˆé•¿ç©ºé—´å¹¶ä¸æ˜¯å¤ªå¤§ï¼Œå¦‚æœè´å¶æ–¯ç®—æ³•çš„æ•ˆæœä¸æ˜¯å¤ªç†æƒ³ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šè€ƒè™‘æ¢æ¨¡å‹ã€‚

  - predict(X)

    > æ¨¡å‹é¢„æµ‹ç»“æœ

  - predict_proba(X)

    > ç»™å‡ºæ¯ä¸€ä¸ªæµ‹è¯•é›†æ ·æœ¬å±äºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œæœ€å¤§çš„å°±æ˜¯åˆ†ç±»ç»“æœ

  - predict_log_proba(X)

    > predict_probaçš„å¯¹æ•°è½¬åŒ–ï¼Œæœ€å¤§çš„å°±æ˜¯åˆ†ç±»ç»“æœ

  - ä½¿ç”¨ç¤ºä¾‹

    ```python
    import numpy as np
    import matplotlib.pyplot as plt
    from sklearn.naive_bayes import GaussianNB
    from sklearn.datasets import load_digits
    from sklearn.model_selection import train_test_split
    
    digits = load_digits()
    X, y = digits.data, digits.target
    Xtrain,Xtest,Ytrain,Ytest = train_test_split(X,y,test_size=0.2,random_state=420)
    
    gnb = GaussianNB()
    gnb.fit(Xtrain,Ytrain)
    
    #æŸ¥çœ‹åˆ†æ•°
    acc_score = gnb.score(Xtest,Ytest)
    acc_score#0.8472222222222222
    ```

- ç»éªŒ

  > è´å¶æ–¯æœ¬èº«æ›´åŠ æ“…é•¿çº¿æ€§å¯åˆ†çš„äºŒåˆ†æ•°æ®ï¼Œä½†æœ´ç´ è´å¶æ–¯åœ¨ç¯å½¢æ•°æ®å’Œæœˆäº®å‹æ•°æ®ä¸Šä¹Ÿå¯ä»¥æœ‰è¿œè¿œèƒœè¿‡å…¶ä»–çº¿æ€§æ¨¡å‹çš„è¡¨ç°ã€‚

  ![1587106702231](asserts/1587106702231.png)

  ![1587106714478](asserts/1587106714478.png)

### å¤šé¡¹å¼æ¨¡å‹

- ä»‹ç»

  - ä¸é«˜æ–¯åˆ†å¸ƒç›¸åï¼Œå¤šé¡¹å¼æ¨¡å‹ä¸»è¦é€‚ç”¨äº**ç¦»æ•£ç‰¹å¾**çš„æ¦‚ç‡è®¡ç®—ï¼Œä¸”sklearnçš„å¤šé¡¹å¼æ¨¡å‹ä¸æ¥å—è¾“å…¥è´Ÿå€¼ã€‚è™½ç„¶sk-learnä¸­çš„å¤šé¡¹å¼æ¨¡å‹ä¹Ÿå¯ä»¥è¢«ç”¨ä½œåœ¨è¿ç»­æ€§ç‰¹å¾æ¦‚ç‡è®¡ç®—ä¸­ï¼Œä½†æ˜¯æˆ‘ä»¬å¦‚æœæƒ³è¦å¤„ç†è¿ç»­æ€§å˜é‡åˆ™æœ€å¥½é€‰æ‹©ä½¿ç”¨é«˜æ–¯æ¨¡å‹ã€‚

    > æ³¨æ„ï¼šå› ä¸ºå¤šé¡¹å¼ä¸æ¥å—è´Ÿå€¼çš„è¾“å…¥ï¼Œæ‰€ä»¥å¦‚æœæ ·æœ¬æ•°æ®çš„ç‰¹å¾ä¸ºæ•°å€¼å‹æ•°æ®çš„è¯ï¼ŒåŠ¡å¿…è¦è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ä¿è¯ç‰¹å¾æ•°æ®ä¸­æ— è´Ÿå€¼å‡ºç°ï¼ï¼ï¼

- åŸç†ï¼šè®¡ç®—å‡ºä¸€ç¯‡æ–‡ç« ä¸ºæŸäº›ç±»åˆ«çš„æ¦‚ç‡ï¼ˆæ–‡ç« æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¯¥è¿ç« ä¸ºå‰æä¸‹æ±‚å‡ºæ‰€å±ç±»åˆ«çš„æ¦‚ç‡ï¼Œå› æ­¤æ–‡ç« å°±æ˜¯æ¦‚ç‡è®ºä¸­æ¡ä»¶æ¦‚ç‡çš„æ¡ä»¶ï¼‰ï¼Œæœ€å¤§æ¦‚ç‡çš„ç±»å‹å°±æ˜¯è¯¥æ–‡ç« çš„ç±»åˆ«ã€‚
  - P(ç±»åˆ«|æ–‡ç« )ï¼šç±»åˆ«å¯ä»¥ä¸ºå†›äº‹ï¼Œè´¢ç»ï¼Œä½“è‚²ç­‰ç­‰ï¼Œæ–‡ç« å…¶å®å°±æ˜¯ä¸€ä¸ªåˆä¸€ä¸ªçš„è¯è¯­
    - P(ä½“è‚²|è¯1ï¼Œè¯2ï¼Œè¯3......)==1/6
    - P(è´¢ç»|è¯1ï¼Œè¯2ï¼Œè¯3......)==1/3
    - åˆ™è¯¥æ–‡ç« å±äºè´¢ç»ç±»åˆ«ï¼Œé‚£ä¹ˆP(è´¢ç»|è¯1ï¼Œè¯2ï¼Œè¯3......)å¦‚ä½•è®¡ç®—å€¼å‘¢ï¼Ÿå¦‚ä½•è®¡ç®—å¤šä¸ªæ¡ä»¶ä¸‹ä¸€ä¸ªç»“æœçš„æ¦‚ç‡å‘¢ï¼Ÿ

- æœ´ç´ è´å¶æ–¯ç®—æ³•å…¬å¼

  ![1587106814104](asserts/1587106814104.png)

- ç»†èŠ‚è§£é‡Š

  - wä¸ºç»™å®šæ–‡æ¡£çš„ç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯æ–‡ç« ä¸­æ‹†åˆ†å‡ºæ¥çš„ä¸åŒè¯è¯­
  - cä¸ºæ–‡æ¡£çš„ç±»åˆ«ï¼ˆè´¢ç»ï¼Œä½“è‚²ï¼Œå†›äº‹......ï¼‰

- é‚£ä¹ˆï¼šä¸€ç¯‡æ–‡æ¡£ä¸ºè´¢ç»å’Œå†›äº‹çš„æ¦‚ç‡è®¡ç®—å¦‚ä¸‹

  - P(è´¢ç»|è¯1ï¼Œè¯2ï¼Œè¯3)==ã€‹P(è¯1ï¼Œè¯2ï¼Œè¯3|è´¢ç»)*P(è´¢ç»)/P(W)
  - P(å†›äº‹|è¯1ï¼Œè¯2ï¼Œè¯3)==ã€‹P(è¯1ï¼Œè¯2ï¼Œè¯3|å†›äº‹)*P(å†›äº‹)/P(W)
  - ä¸Šè¿°ä¸¤ä¸ªå…¬å¼ä¸­éƒ½æœ‰æƒ³ç”¨çš„P(W),å¯ä»¥æŠµæ¶ˆï¼Œåˆ™å…¬å¼ç®€åŒ–ä¸ºï¼š
    - P(è¯1ï¼Œè¯2ï¼Œè¯3|è´¢ç»)*P(è´¢ç»)==ã€‹P(W|C)*P(C)
    - P(è¯1ï¼Œè¯2ï¼Œè¯3|å†›äº‹)*P(å†›äº‹)==>P(W|C)*P(C)
    - è¿™æ ·çš„å…¬å¼æˆ‘ä»¬æ˜¯å¯ä»¥è¿›è¡Œè®¡ç®—çš„ï¼Œè¿™å°±æ˜¯æ¡ä»¶æ¦‚ç‡
  - P(C):æ¯ä¸ªæ–‡æ¡£ç±»åˆ«çš„æ¦‚ç‡ï¼ˆæŸä¸ªæ–‡æ¡£ç±»åˆ«æ–‡ç« çš„æ•°é‡/æ€»æ–‡æ¡£æ•°é‡ï¼‰
  - P(W|C):ç»™å®šç±»åˆ«ä¸‹ç‰¹å¾çš„æ¦‚ç‡ï¼Œæ­¤å¤„çš„ç‰¹å¾å°±æ˜¯é¢„æµ‹æ–‡æ¡£ä¸­å‡ºç°çš„è¯è¯­
    - P(W|C)çš„è®¡ç®—æ–¹æ³•
      - P(F1|C)=Ni/N:F1ä¸ºé¢„æµ‹æ–‡æ¡£ä¸­çš„æŸä¸€ä¸ªè¯ï¼ŒCä¸ºæŒ‡å®šçš„ç±»åˆ«
        - Niï¼šF1è¿™ä¸ªè¯åœ¨Cç±»åˆ«æ‰€æœ‰æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°
        - Nï¼šæ‰€å±ç±»åˆ«Cä¸‹çš„æ–‡æ¡£æ‰€æœ‰è¯å‡ºç°çš„æ¬¡æ•°å’Œ

- å®ä¾‹æ¨å¯¼ï¼Œè¯·çœ‹é¢˜

  ![1587106910967](asserts/1587106910967.png)

  - è§£é‡Š

    > ä¸Šå›¾çš„è¡¨æ ¼ä¸ºè®­ç»ƒé›†çš„ç»Ÿè®¡ç»“æœï¼Œè®­ç»ƒé›†ä¸­ä¸€å…±æœ‰30ç¯‡ç§‘æŠ€æ–‡ç« ï¼Œ60ç¯‡å¨±ä¹æ–‡ç« ï¼Œå…±è®¡90ç¯‡æ–‡ç« ã€‚è¿™äº›æ–‡ç« ä¸­æ ¹æ®tf-idfæå–å‡ºé‡è¦çš„è¯è¯­åˆ†åˆ«æœ‰(å•†åœºï¼Œå½±é™¢ï¼Œæ”¯ä»˜å®å’Œäº‘è®¡ç®—)ï¼Œç„¶åè¿™äº›è¯åˆ†åˆ«åœ¨ä¸åŒè®­ç»ƒé›†ä¸­ä¸åŒç±»åˆ«æ–‡ç« ä¸­å‡ºç°çš„æ¬¡æ•°ä¹Ÿç»Ÿè®¡å‡ºæ¥äº†ã€‚

  - ç°åœ¨æœ‰ä¸€ä¸ªå°†è¦è¢«é¢„æµ‹çš„æ–‡ç« ï¼Œè¯¥æ–‡ç« ä¸­å‡ºç°é‡è¦çš„æ¬¡ä¸ºå½±é™¢ï¼Œæ”¯ä»˜å®å’Œäº‘è®¡ç®—ï¼Œåˆ™è®¡ç®—è¯¥æ–‡ç« å±äºç§‘æŠ€ã€å¨±ä¹çš„æ¦‚ç‡åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ

    ![1587106981289](asserts/1587106981289.png)

  - æ€è€ƒï¼šå±äºæŸä¸ªç±»åˆ«çš„æ¦‚ç‡ä¸º0ï¼Œåˆé€‚å—ï¼Ÿ

    > è‚¯å®šä¸åˆé€‚ï¼Œè™½ç„¶è¢«é¢„æµ‹æ–‡ç« ä¸­æ²¡æœ‰å‡ºç°äº‘è®¡ç®—è¿™ä¸ªè¯è¯­ï¼Œä½†æ˜¯å‡ºç°å¨±ä¹ç±»åˆ«ä¸­çš„å…¶ä»–è¯ï¼Œæ‰€ä»¥æ¦‚ç‡ä¸º0ä¸åˆé€‚ï¼é‚£ä¹ˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ

    ![1587107018000](asserts/1587107018000.png)

- æœ´ç´ è´å¶æ–¯API

  - from sklearn.naive_bayes import MultinomialNB
  - MultinomialNB(alpha=1.0, fit_prior=True, class_prior=None)
    - alpha:æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ç³»æ•°

#### ä½¿ç”¨ç¤ºä¾‹

- å®æˆ˜

  - æ•°æ®ä½¿ç”¨

    > æ•°æ®ä½¿ç”¨fetch_20newsgroupsä¸­çš„æ•°æ®ï¼ŒåŒ…å«äº†20ä¸ªä¸»é¢˜çš„18000ä¸ªæ–°é—»ç»„çš„å¸–å­

  - æµç¨‹

    - åŠ è½½20ç±»æ–°é—»æ•°æ®ï¼Œå¹¶è¿›è¡Œæ ·æœ¬åˆ†å‰²
    - ç”Ÿæˆæ–‡ç« ç‰¹å¾è¯
    - ä½¿ç”¨æ¨¡å‹è¿›è¡Œæ–‡ç« åˆ†ç±»

- sklearnæ–‡æœ¬ç‰¹å¾æå–â€”â€”TfidfVectorizerï¼ˆæ±‚å‡ºNi/Nçš„å€¼ï¼‰

  - ä»€ä¹ˆæ˜¯TF-IDF

    - Ni/Nå¯ä»¥è¡¨ç¤ºä¸€ä¸ªè¯å¯¹äºæ•´ç‰‡æ–‡ç« çš„é‡è¦æ€§ã€‚

    - TF

      > è¯é¢‘ã€‚TF(w)=(è¯wåœ¨æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°)/(æ–‡æ¡£çš„æ€»è¯æ•°) == P(F1|C)=Ni/N

    - IDF

      > é€†å‘æ–‡ç« é¢‘ç‡ã€‚æœ‰äº›è¯å¯èƒ½åœ¨æ–‡æœ¬ä¸­é¢‘ç¹å‡ºç°ï¼Œä½†å¹¶ä¸é‡è¦ï¼Œä¹Ÿå³ä¿¡æ¯é‡å°ï¼Œå¦‚is,of,thatè¿™äº›å•è¯ï¼Œè¿™äº›å•è¯åœ¨è¯­æ–™åº“ä¸­å‡ºç°çš„é¢‘ç‡ä¹Ÿéå¸¸å¤§ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ç‚¹ï¼Œé™ä½å…¶æƒé‡ã€‚IDF(w)=log_e(è¯­æ–™åº“çš„æ€»æ–‡æ¡£æ•°)/(è¯­æ–™åº“ä¸­è¯wã€Šis,of...ã€‹å‡ºç°çš„æ–‡æ¡£æ•°)ã€‚eæ˜¯è‡ªç„¶å¯¹æ•°çš„åº•æ•°ï¼Œæ˜¯ä¸€ä¸ªæ— é™ä¸å¾ªç¯å°æ•°ï¼Œå…¶å€¼æ˜¯2.71828...

    - TF-IDF

      > å°†ä¸Šé¢çš„TF-IDFç›¸ä¹˜å°±å¾—åˆ°äº†ç»¼åˆå‚æ•°ï¼šTF-IDF=TF*IDF

- ä»£ç ç¤ºä¾‹

  - è·å–æ•°æ®

    ```python
    import sklearn.datasets as datasets
    from sklearn.feature_extraction.text import TfidfVectorizer
    from sklearn.model_selection import train_test_split
    from sklearn.naive_bayes import MultinomialNB
    news = datasets.fetch_20newsgroups(subset='all')
    ```

  - æ ·æœ¬åˆ†å‰²

    ```python
    feature = news.data#è¿”å›çš„æ˜¯åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­ä¸ºä¸€ç¯‡ç¯‡çš„æ–‡ç« 
    target = news.target#è¿”å›çš„ndarray,å­˜å‚¨çš„æ˜¯æ¯ä¸€ç¯‡æ–‡ç« çš„ç±»åˆ«
    x_train,x_test,y_train,y_test = train_test_split(feature,target,test_size=0.25)
    ```

  - å¯¹æ•°æ®é›†è¿›è¡Œç‰¹å¾æŠ½å–

    ```python
    tf = TfidfVectorizer()
    x_train = tf.fit_transform(x_train)#è¿”å›è®­ç»ƒé›†æ‰€æœ‰æ–‡ç« ä¸­æ¯ä¸ªè¯çš„é‡è¦æ€§
    x_test = tf.transform(x_test)#è¿”å›æµ‹è¯•é›†æ‰€æœ‰æ–‡ç« ä¸­æ¯ä¸ªè¯çš„é‡è¦æ€§
    ```

  - æ¨¡å‹è®­ç»ƒ

    ```python
    # print(tf.get_feature_names())#æ‰€æœ‰æ–‡ç« ä¸­å‡ºç°çš„è¯è¯­
    mlt = MultinomialNB(alpha=1)
    mlt.fit(x_train,y_train)
    y_predict = mlt.predict(x_test)
    print('é¢„æµ‹æ–‡ç« ç±»åˆ«ä¸ºï¼š',y_predict)
    print('çœŸå®æ–‡ç« ç±»åˆ«ä¸ºï¼š',y_test)
    print('å‡†ç¡®ç‡ä¸ºï¼š',mlt.score(x_test,y_test))
    -------------
    é¢„æµ‹æ–‡ç« ç±»åˆ«ä¸ºï¼š [3 2 5 ... 6 6 3]
    çœŸå®æ–‡ç« ç±»åˆ«ä¸ºï¼š [6 2 5 ... 6 4 3]
    å‡†ç¡®ç‡ä¸ºï¼š 0.8482597623089984
    ```

- ä½œç”¨åˆ°é¸¢å°¾èŠ±åˆ†ç±»ä¸­

  ```python
  from sklearn import datasets
  from sklearn.naive_bayes import MultinomialNB
  from sklearn.model_selection import train_test_split
  iris = datasets.load_iris()
  feature = iris['data']
  target = iris['target']
  x_train,x_test,y_train,y_test = train_test_split(feature,target,test_size=0.2,random_state=2020)
  gnb = MultinomialNB()
  gnb.fit(x_train,y_train)
  
  #æŸ¥çœ‹åˆ†æ•°
  acc_score = gnb.score(x_test,y_test)
  acc_score#0.9666666666666667
  ```


### ä¼¯åŠªåˆ©æ¨¡å‹BernoulliNB

- ä»‹ç»

  - å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯å¯åŒæ—¶å¤„ç†äºŒé¡¹åˆ†å¸ƒ(æŠ›ç¡¬å¸)å’Œå¤šé¡¹åˆ†å¸ƒ(æ·éª°å­)ï¼Œå…¶ä¸­äºŒé¡¹åˆ†å¸ƒåˆå«åšä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œå®ƒæ˜¯ä¸€ç§ç°å®ä¸­å¸¸è§ï¼Œå¹¶ä¸”æ‹¥æœ‰å¾ˆå¤šä¼˜è¶Šæ•°å­¦æ€§è´¨çš„åˆ†å¸ƒã€‚å› æ­¤ï¼Œæ—¢ç„¶æœ‰ç€å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯ï¼Œæˆ‘ä»¬è‡ªç„¶ä¹Ÿå°±åˆä¸“é—¨ç”¨æ¥**å¤„ç†äºŒé¡¹åˆ†å¸ƒ**çš„æœ´ç´ è´å¶æ–¯:ä¼¯åŠªåˆ©æœ´ç´ è´å¶æ–¯ã€‚
  - ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ•°æ®é›†ä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªç‰¹å¾ï¼Œä½†æ¯ä¸ªç‰¹å¾éƒ½æ˜¯äºŒåˆ†ç±»çš„ï¼Œå¯ä»¥ä»¥å¸ƒå°”å˜é‡è¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥è¡¨ç¤º ä¸º{0ï¼Œ1}æˆ–è€…{-1ï¼Œ1}ç­‰ä»»æ„äºŒåˆ†ç±»ç»„åˆã€‚å› æ­¤ï¼Œè¿™ä¸ªç±»è¦æ±‚å°†æ ·æœ¬è½¬æ¢ä¸ºäºŒåˆ†ç±»ç‰¹å¾å‘é‡ï¼Œå¦‚æœæ•°æ®æœ¬èº«ä¸æ˜¯äºŒåˆ†ç±»çš„ï¼Œé‚£å¯ä»¥ä½¿ç”¨ç±»ä¸­ä¸“é—¨ç”¨æ¥äºŒå€¼åŒ–çš„å‚æ•°binarizeæ¥æ”¹å˜æ•°æ®ã€‚

- ä½œç”¨

  > ä¼¯åŠªåˆ©æœ´ç´ è´å¶æ–¯ä¸å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯éå¸¸ç›¸ä¼¼ï¼Œéƒ½å¸¸ç”¨äºå¤„ç†æ–‡æœ¬åˆ†ç±»æ•°æ®ã€‚ä½†ç”±äºä¼¯åŠªåˆ©æœ´ç´ è´å¶æ–¯æ˜¯å¤„ç†äºŒé¡¹ åˆ†å¸ƒï¼Œæ‰€ä»¥å®ƒæ›´åŠ åœ¨æ„çš„æ˜¯â€œæ˜¯ä¸å¦â€ã€‚åˆ¤å®šä¸€ç¯‡æ–‡ç« æ˜¯å¦å±äºä½“è‚²èµ„è®¯ï¼Œè€Œä¸æ˜¯è¯´å±äºä½“è‚²ç±»è¿˜æ˜¯å¨±ä¹ç±»ã€‚

- API

  - class sklearn.naive_bayes.BernoulliNB (alpha=1.0, binarize=0.0, fit_prior=True, class_prior=None)

  - å‚æ•°ä»‹ç»

    - alpha

      > æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ç³»æ•°

    - binarize

      > å¯ä»¥æ˜¯æ•°å€¼æˆ–è€…ä¸è¾“å…¥ã€‚å¦‚æœä¸è¾“å…¥ï¼Œåˆ™BernoulliNBè®¤ä¸ºæ¯ä¸ªæ•°æ®ç‰¹å¾éƒ½å·²ç»æ˜¯äºŒå…ƒï¼ˆäºŒå€¼åŒ–ï¼‰çš„ã€‚å¦åˆ™çš„è¯ï¼Œå°äºbinarizeçš„ä¼šå½’ä¸ºä¸€ç±»ï¼Œå¤§äºbinarizeçš„ä¼šå½’ä¸ºå¦å¤–ä¸€ç±»

- äºŒå€¼åŒ–æ“ä½œ

  ```python
  from sklearn import preprocessing
  import numpy as np
   
  X = np.array([[1,-2,2,3,1,10],
               [1,2,3,33,4,-90],
               [11,29,90,-80,0,4]])
  binarizer = preprocessing.Binarizer(threshold=5)
  X_binarizer = binarizer.transform(X)
  print("äºŒå€¼åŒ–ï¼ˆé—¸å€¼ï¼š5ï¼‰",X_binarizer)
  ----------------
  äºŒå€¼åŒ–ï¼ˆé—¸å€¼ï¼š5ï¼‰ [[0 0 0 0 0 1]
   [0 0 0 1 0 0]
   [1 1 1 0 0 0]]
  ```

- ä»£ç ç¤ºä¾‹

  ```python
  import numpy as np
  import matplotlib.pyplot as plt
  from sklearn.naive_bayes import BernoulliNB
  from sklearn.datasets import load_digits
  from sklearn.model_selection import train_test_split
  
  digits = load_digits()
  X, y = digits.data, digits.target
  Xtrain,Xtest,Ytrain,Ytest = train_test_split(X,y,test_size=0.2,random_state=420)
  
  gnb = BernoulliNB(binarize=3)
  gnb.fit(Xtrain,Ytrain)
  
  #æŸ¥çœ‹åˆ†æ•°
  acc_score = gnb.score(Xtest,Ytest)
  acc_score
  ```

  